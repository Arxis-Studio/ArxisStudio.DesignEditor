<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:DesignEditor.Demo.ViewModels"
        xmlns:arxisStudio="clr-namespace:ArxisStudio;assembly=ArxisStudio.DesignEditor"
        mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        x:Class="DesignEditor.Demo.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="DesignEditor.Demo"
        WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Resources>
        <Color x:Key="BackgroundColor">#141417</Color>
        <SolidColorBrush x:Key="BackgroundBrush" Color="{StaticResource BackgroundColor}" />
        <SolidColorBrush x:Key="SmallLineBrush" Color="#26292E" />
        <SolidColorBrush x:Key="LargeLineBrush" Color="#3E4451" />

        <DrawingGroup x:Key="UnifiedGridDrawing">
             <GeometryDrawing Brush="{StaticResource BackgroundBrush}">
                <GeometryDrawing.Geometry>
                    <RectangleGeometry Rect="0,0,100,100" />
                </GeometryDrawing.Geometry>
            </GeometryDrawing>
            <GeometryDrawing Brush="{x:Null}">
                <GeometryDrawing.Pen>
                    <Pen Brush="{StaticResource SmallLineBrush}" Thickness="1" />
                </GeometryDrawing.Pen>
                <GeometryDrawing.Geometry>
                    <GeometryGroup>
                        <LineGeometry StartPoint="20,0" EndPoint="20,100" />
                        <LineGeometry StartPoint="40,0" EndPoint="40,100" />
                        <LineGeometry StartPoint="60,0" EndPoint="60,100" />
                        <LineGeometry StartPoint="80,0" EndPoint="80,100" />
                        <LineGeometry StartPoint="0,20" EndPoint="100,20" />
                        <LineGeometry StartPoint="0,40" EndPoint="100,40" />
                        <LineGeometry StartPoint="0,60" EndPoint="100,60" />
                        <LineGeometry StartPoint="0,80" EndPoint="100,80" />
                    </GeometryGroup>
                </GeometryDrawing.Geometry>
            </GeometryDrawing>
            <GeometryDrawing Brush="{x:Null}">
                <GeometryDrawing.Pen>
                    <Pen Brush="{StaticResource LargeLineBrush}" Thickness="1" />
                </GeometryDrawing.Pen>
                <GeometryDrawing.Geometry>
                    <StreamGeometry>M0,0 L100,0 M0,0 L0,100</StreamGeometry>
                </GeometryDrawing.Geometry>
            </GeometryDrawing>
        </DrawingGroup>

        <DrawingBrush x:Key="DesignEditorGridBrush"
                      TileMode="Tile"
                      DestinationRect="0 0 100 100"
                      Transform="{Binding DpiScaledViewportTransform, ElementName=Editor}"
                      Drawing="{StaticResource UnifiedGridDrawing}" />
    </Window.Resources>

    <Grid Background="{StaticResource BackgroundBrush}">

        <arxisStudio:DesignEditor x:Name="Editor"
                                 Background="{StaticResource DesignEditorGridBrush}"
                                 ItemsSource="{Binding Nodes}"
                                 SelectedItems="{Binding SelectedNodes}"
                                 SelectionMode="Multiple">

            <arxisStudio:DesignEditor.Styles>
                <Style Selector="arxisStudio|DesignEditorItem" x:DataType="vm:DesignItemViewModel">
                    <Setter Property="Canvas.Left" Value="{Binding X}"/>
                    <Setter Property="Canvas.Top" Value="{Binding Y}"/>
                </Style>
            </arxisStudio:DesignEditor.Styles>

            <arxisStudio:DesignEditor.DataTemplates>
                <DataTemplate DataType="{x:Type vm:LoginNodeViewModel}">
                    <Border Width="340" Background="#202020" BorderBrush="#383838" BorderThickness="1" CornerRadius="12" Padding="30" BoxShadow="0 10 20 0 #50000000">
                        <StackPanel Spacing="20">
                            <TextBlock Text="Login Form" FontSize="18" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
                            <StackPanel Spacing="12">
                                <TextBox Watermark="Email" CornerRadius="6" Background="#2D2D2D" Foreground="White"/>
                                <Button Content="Sign In" HorizontalAlignment="Stretch" Background="#4C97FF" Foreground="White"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </DataTemplate>

                <DataTemplate DataType="{x:Type vm:DashboardNodeViewModel}">
                    <Border Width="700" Height="500" Background="#202020" BorderBrush="#383838" BorderThickness="1" CornerRadius="12" Padding="20">
                        <TextBlock Text="Dashboard" FontWeight="Bold" FontSize="16" Foreground="White"/>
                    </Border>
                </DataTemplate>
            </arxisStudio:DesignEditor.DataTemplates>

        </arxisStudio:DesignEditor>

        <Border VerticalAlignment="Top" HorizontalAlignment="Center" Margin="0,20,0,0" Background="#CC202020" BorderBrush="#383838" BorderThickness="1" CornerRadius="10" Padding="15,8">
            <StackPanel Orientation="Horizontal" Spacing="15" VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal" Spacing="5">
                    <TextBlock Text="Selected:" Foreground="#888"/>
                    <TextBlock Text="{Binding SelectedNodes.Count}" Foreground="#4C97FF" FontWeight="Bold"/>
                </StackPanel>

                <Rectangle Width="1" Height="20" Fill="#383838"/>

                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock Text="Zoom" Foreground="#888" VerticalAlignment="Center"/>
                    <Slider Width="100" Minimum="{Binding #Editor.MinZoom}" Maximum="{Binding #Editor.MaxZoom}" Value="{Binding #Editor.ViewportZoom}" TickFrequency="0.1" IsSnapToTickEnabled="False"/>
                    <TextBlock Text="{Binding #Editor.ViewportZoom, StringFormat='{}{0:P0}'}" Foreground="White" Width="40" TextAlignment="Right"/>
                </StackPanel>
            </StackPanel>
        </Border>

    </Grid>
</Window>
